% This template uses the scontents package, which is only available on relatively recent TeX distributions. In case it is not available on your system, use the legacy_template.tex
\documentclass[varwidth=true, crop, border=5pt]{standalone}

% Packages
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathrsfs}


% for storing in memory verbatim content to be reused later
\usepackage{scontents}

% Blank formula checking
\usepackage{ifthen}
\newlength{\pheight}

% custom formulas
\usepackage[thinc]{esdiff}
\usepackage{esint}

% Color support
\usepackage{xcolor}
\definecolor{xpp_font_color}{HTML}{%%XPP_TEXT_COLOR%%}

% Some conveniences for me
\newcommand{\Laplace}[1]{\mathscr{L}\left[#1\right]}
\newcommand{\InvLaplace}[1]{\mathscr{L}^{-1}\left[#1\right]}

% vectors
\newcommand{\qvector}[4]{\begin{bmatrix}  #1 \\ #2 \\#3 \\#4 \end{bmatrix}}
\newcommand{\tvector}[3]{\begin{bmatrix}  #1 \\ #2 \\#3\end{bmatrix}}
\newcommand{\dvector}[2]{\begin{bmatrix} #1 \\ #2 \end{bmatrix}}

% matricies
\newcommand{\tmatrix}[9]{\begin{bmatrix} #1 & #2 & #3 \\ #4 & #5 & #6 \\ #7 & #8 & #9\end{bmatrix}}
\newcommand{\dmatrix}[4]{\begin{bmatrix} #1&#2 \\ #3 & #4\end{bmatrix}}
% col major order TODO
\newcommand{\tcmatrix}[9]{\begin{bmatrix} #1 & #2 & #3 \\ #4 & #5 & #6 \\ #7 & #8 & #9 \end{bmatrix}}
\newcommand{\dcmatrix}[4]{\begin{bmatrix} #1&#2 \\ #3 & #4 \end{bmatrix}}

% little naught convention
\newcommand{\naught}[1]{{#1_0}}

% piecewise func
\newcommand{\dpiecewise}[4]{\left\{\begin{array}{lr} #1, & \text{if} #2 \\ #3, & \text{if} #4 \end{array} \right\}}
\newcommand{\tpiecewise}[6]{\left\{\begin{array}{lr} #1, & \text{if} #2 \\ #3, & \text{if} #4 \\ #5, & \text{if } #6 \end{array} \right\} }

% User input
\begin{scontents}[store-env=preview]
	\( 
	\displaystyle
    %%XPP_TOOL_INPUT%%
	\)
\end{scontents}

\begin{document}
  % Check if the formula is empty
  \settoheight{\pheight}{\getstored[1]{preview}}%
  \ifthenelse{\pheight=0}{\GenericError{}{xournalpp:blankformula}{}{}}

  % Render the user input
  \textcolor{xpp_font_color}{\getstored[1]{preview}}
\end{document}
